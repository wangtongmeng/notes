# react面试题简答版

## 概念题
### 说说你对react的理解
- 是什么：React是一个用于构建用户界面的 js 库。
- 能干什么：通过组件化的方式构建快速响应的大型 Web 应用程序。
- 如何干的：
   - 声明式渲染：使用声明式的方式编写用户界面。
   - 组件化：把页面拆分为一个个组件，方便视图的拆分和复用，还可以做到高内聚和低耦合
   - 一次学习，随处编写：React可以开发Web、移动端、vR和命令行程序。
- 优缺点：
   - 优点：开发团队和社区强大；一次学习，随处编写；API 比较简洁
   - 缺点：没有官方系统解决方案，选型成本高；过于灵活，不容易写出高质量的应用
- 扩展：JSX 实现声明式；虚拟 DOM 可以实现跨平台；React 使用的设计模式；自己 React 大型架构经验
### 为什么引入jsx
- jsx是js的扩展，可以通过html+js的方式进行UI的描述，最终通过babel编译成 React.createElement （最新版是_jsx）的语法糖
- JSX工作原理：通过babel将jsx解析成ast抽象语法树，再生成code源代码(也就是createElement函数)
## react基础
### 函数和类组件的异同点？
- 编程思想：一个基于函数式编程，一个面向对象。
- 内存占用：函数组件更节约内存。
- 可测试性：函数组件更方便编写单元测试。
- 可复用性：组合优于继承，函数式组件通过hooks实现复用。
### 请说一下你对 React 合成事件的理解？
- React 把事件委托到 document 对象上
- 当真实 DOM 元素触发事件,先处理原生事件，然后会冒泡到 document 对象后,再处理 - React 事件
- React 事件绑定的时刻是在 reconciliation 阶段,会在原生事件的绑定前执行
- 目的和优势
   - 进行浏览器兼容,React 采用的是顶层事件代理机制，能够保证冒泡一致性
   - 事件对象可能会被频繁创建和回收，因此 React 引入事件池,在事件池中获取或释放事件对象(React17 中被废弃)
### setState的更新是同步还是异步的?
setState默认是异步更新的，setState时会先把更新的内容放入队列，在事件执行结束后会计算state的数据，然后执行回调，最后根据最新的state计算虚拟DOM更新真实DOM。setState设计为异步，可以显著的提升性能。
在React无法控制的地方无法设置批量执行（addEventListener、setTimeout和setInterval）

并发模式？
## hooks
### 为什么不能在条件和循环里使用Hooks?
因为在每次组件渲染时，Hooks的调用顺序必须是固定的，因为 hooks 为了在函数组件中引入状态，维护了一个有序表。而条件和循环语句会导致hooks的顺序发生错乱，从而发生取值和更新值是发生错误。
### 为什么不能在函数组件外部使用Hooks?
Hooks 是为了在函数组件中添加状态和其他 React 特性的机制。Hooks 的设计目的是为了解决类组件中的一些问题，并提供一种更简洁和可维护的方式来处理组件的状态和副作用。

Hooks 的使用规则之一是它们只能在 React 函数组件的顶层作用域中使用，而不能在函数组件的外部使用。这是由于 React 对于 Hooks 的调用顺序和作用域管理的限制。

不能在函数组件外部使用 Hooks有以下原因：

调用顺序的依赖：React 依赖于 Hooks 的调用顺序来追踪组件的状态和副作用。每个 Hook 都有一个特定的顺序和索引，React 使用这些顺序和索引来确保状态和副作用与组件正确地关联起来。如果在函数组件外部使用 Hooks，就无法保证 Hooks 的调用顺序，从而导致 React 无法正确地管理组件的状态。

组件实例化的限制：函数组件是无状态的，它们没有实例化的概念。因此，在函数组件外部使用 Hooks 并不符合 React 组件的实例化模型。Hooks 的设计目的是为了与函数组件的生命周期和状态管理一起工作，而这些概念在函数组件外部是不存在的。

难以管理多个组件状态：Hooks 被设计为与特定的函数组件关联，用于管理该组件的状态和副作用。如果在函数组件外部使用 Hooks，就无法明确指定它们所关联的组件，从而导致状态管理变得混乱和困难。

总之，React 中的 Hooks 是为了在函数组件内部提供一种方便和一致的方式来处理状态和副作用。它们受到 React 生命周期和组件实例化模型的限制，所以不能在函数组件外部使用。如果需要在函数组件外部共享逻辑或状态，可以考虑使用其他的 React 特性，如自定义 Hook 或组件组合等。
### React Hooks的状态保存在了哪里?
React Hooks 的状态是保存在函数组件内部的 Fiber 数据结构的 memoizedState 字段中。每个 Hook 对应一个状态节点，这些节点以链表的形式组织起来，与函数组件的实例关联在一起。这种方式使得在函数组件中使用多个 Hook 可以独立管理状态，并确保状态在组件重新渲染时正确更新。
### 为什么传入二次相同的状态，函数组件不更新?
当传入相同的状态值给函数组件时，函数组件可能不会触发重新渲染，这是因为 React 使用浅比较来判断状态是否发生变化。这种行为是为了提高性能，避免不必要的渲染操作。
### 函数组件的useState和类组件的setState有什么区别?

## 生命周期
### React的渲染流程
React基于Fiber架构渲染，一个Fiber是一个执行单元，React的渲染会在浏览器空闲时间进行，当空闲时间不够时，会将控制权交给浏览器（事件处理、js执行、布局/绘制等），等待下一帧的空闲时间再继续渲染，所以渲染是**异步可中断+增量更新**的

React16+的渲染流程

React工作的三个阶段
- scheduler(调度) 确定最高优的任务并进入reconciler
- reconciler 计算变更的内容
- react-dom renderer(渲染) 把变化的内容更新到DOM上
### React 中的 DOM-DIFF 算法
在 React17+中 DOM-DIFF 就是根据老的 fiber 树和最新的 JSX 对比生成新的 fiber 树的过程

优化原则：
- **同级对比**：只对同级节点进行对比，如果 DOM 节点跨层级移动，则 React 不会复用
- **比较类型**：不同类型的元素会产出不同的结构 ，会销毁老结构，创建新结构
- **比较key**：可以通过 key 标识移动的元素

具体流程：
- 新节点是单节点：若老节点能复用（type和key相同），则复用老fiber节点，否则删掉生成新的fiber节点。
- 新节点是新多节点：可能更新、删除、新增（增删改）。通过两轮遍历，第一轮遍历主要是处理节点的更新,更新包括属性和类型的更新；第二轮遍历主要处理节点的新增、删除和移动；移动时的原则是尽量少量的移动，如果必须有一个要动，新地位高的不动，新地位低的动。
### 说一下你对 Virtual DOM 的理解？
- vdom 就是一个描述真实DOM的纯 js 对象，React.createElement 函数所返回的就是一个虚拟 DOM。
- 优点：解决了浏览器兼容性的问题，并且进行了xss处理，跨平台，更新时优化等。
- 缺点：生成vdom消耗内存，首次渲染会有生成虚拟DOM的开销。




## react性能优化
## 版本更新
### react18更新了哪些新特性
## 数据管理
### redux
### mobx
## react路由

